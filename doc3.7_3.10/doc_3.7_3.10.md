<!-- $theme: gaia -->

# チーム開発実践入門
## 3.7-3.10
### Jun Kimura

---
<!-- page_number: true -->

# Overview

### 3.7-3.9の内容

==「プログラム以外の実行に必要な情報をどう扱うか」==

* 3.7 データベーススキーマ
* 3.8 設定ファイル
* 3.9 依存関係

---
# 3.7 データベーススキーマ

データベーススキーマって？

* 要するにDBのテーブル定義
  * 1列目は名前(文字列型)、2列目は生年月日(日付型)みたいな
* 滅多に行わない処理なので、ついつい対話型(GUI or CUI)のツールで作成してしまうことが多い
  * PostgreSQLならpsql(CUI), SQLServerならSQL Server Management Studio(GUI)
* 生成手順が管理されないので、自動再生成できなくなっちゃう

---

#### 理想の形は？

* どんな環境でも、何回でも同じ手順でテーブル生成出来ることが重要(CIで必須)
* githubで管理するからにはテキストファイルであるべき

##### じゃあ、SQL構文を管理する？

* 冪等性がない(=常にDBをクリアして新規に作成する必要がある)

##### そんなのいやぁぁぁ！！！！

---

### どうすれば？

世の中にはmigrationツールというものがあるので使いましょう。

* 冪等性があり既にテーブル存在していても適切に変更される
* よく使われるframework(RoR, Django)では標準装備<small>(railsアプリで"rake db:migrate"とか実行したことありません？あれです。)</small>
* framework使っていない場合でもmigrationに特化したツールもあるのでご心配なく

<small>某コラボでもmigrationツール使っていれば毎回DBクリアは避けられたかもしれないですね。</small>

---
# 3.8 設定ファイル

ここで言う設定ファイルとは、動作する環境毎に異なる内容となるファイルのこと(例:Apacheの設定)

* これもうっかり手動で書き換えてしまって自動化されにくい項目
* 昔はShellスクリプトを駆使して必死に自動化してましたが、今はいいもの一杯あります
  * Chef, Puppet, Capstrano, Fabric, Ansible...
* 目的によって適切なツールが違うのですが、思うところがあり次のページで。。。

---
## 設定管理ツールで思う所

昔はChef, Puppetが代表的なコンフィギュレーションツール。Capstrano, Fabricがデプロイツールでしたが、今はAnsible一択で良いような気がします。

1. コンフィギュレーションツールとしてもデプロイツールとしても使える
2. 学習コストが低め
3. 冪等性がある

Ansibleは本書では触れられていないので6.4で説明しようかと思います<small>(むしろ今更Chefは。。。)</small>

---
## 担当プロジェクトでの導入状況

サーバーが存在するプロジェクトが皆無だったので情報量少なめ。。。

| プロジェクト | 導入 | コメント |
|:-----------|:--|:-----------|
|L◯n◯|◯|当初手動だったが途中からFablicを導入|
|某コラボ|？|誰か知っていたら教えて。。。|

---

# 3.9 依存関係

OSSなどのライブラリもテキストファイルで、どんな状況でも同じライブラリが利用できるように管理したい。

* 昔(Cは今も)はライブラリもgit等にコミットしたり、自動的にapt-getするスクリプト用意していた
* 今時は言語毎にライブラリの依存関係を解決する仕組みが整っている
  * Ant, Maven, Gradle, npm, CPAN, pip, RubyGems

<small>ちなPythonやJavaは言語制定時にライブラリ依存管理の概念がなかったので事情を知らない人にはどれが今時か分かりにくい</small>

---
## 担当プロジェクトでの導入状況

サーバーが存在するプロジェクトが皆無だったので情報量少なめ。。。

| プロジェクト | 導入 | コメント |
|:-----------|:--|:-----------|
|Printer Driver|×|だってC++ですし。。。|
|S◯il-◯J1|×|だってC++ですし。。。|
|L◯n◯|△|npm, Ant|
|Ch◯ahアプリ|◯|Gradle|
|H◯an-P1|◯|nuget|
|某コラボ|◯?|Maven, npm, nuget|

---

# 3.10 まとめ

* バージョン管理ツールを使うことで、ソースコードとドキュメント、DBスキーマや実行環境の設定ファイルの管理を行うことが出来るようにはなった。
* バージョン管理ツールでは変更理由については管理しない。次章から説明するチケット管理ツールと連携して行う。

---
<!-- page_number: false -->

# 以上です。
# ご清聴ありがとうございました。